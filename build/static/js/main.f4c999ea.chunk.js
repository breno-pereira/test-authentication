(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{145:function(e,t){},161:function(e,t,a){e.exports=a(296)},179:function(e,t,a){},209:function(e,t){},211:function(e,t){},243:function(e,t){},244:function(e,t){},292:function(e,t){},293:function(e,t){},294:function(e,t){},296:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(93),c=a.n(s),o=a(60),i=a(148),l=(a(179),a(25)),u=a(26),m=a(28),d=a(27),f=a(29),h=a(50),p=a(308),v=a(312),g=a(313),b=a(311),E=a(301),y=a(298),x=a(299),w=a(300),j=a(302),O=a(149),S=a.n(O).a.create({baseURL:"http://api-codeinquero.herokuapp.com/"}),k=a(30),F=a.n(k),N=a(15),C=a(7);function I(){var e=Object(N.a)(["\n  height: auto;\n  margin-right: 20px;\n  width: 100%;\n"]);return I=function(){return e},e}function D(){var e=Object(N.a)(["\n  align-items: center;\n  background: linear-gradient(to top, #18acc4, #0e5780);\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  min-height: 100vh;\n  width: 100vw;\n"]);return D=function(){return e},e}var T=C.c.div(D()),U=C.c.img(I()),Y=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={errors:null,userTests:[],getUserTestInterval:0},a.getColor=function(e){switch(e){case"INDISPONIVEL":return"#F00";case"AGUARDANDO INICIO":return"#d8d838";case"EM ANDAMENTO":return"#2d39ad";case"CONCLUIDO":return"#1d8444"}},a}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=JSON.parse(sessionStorage.getItem("userLogged"));S.get("/get-user-test/".concat(t.id)).then(function(t){var a=t.data;e.setState({userTests:a})});var a=setInterval(function(){S.get("/get-user-test/".concat(t.id)).then(function(t){var a=t.data;e.setState({userTests:a})})},3e3);this.setState({getUserTestInterval:a})}},{key:"componentWillUnmount",value:function(){clearInterval(this.state.getUserTestInterval)}},{key:"render",value:function(){var e=this;return r.a.createElement(T,null,r.a.createElement(y.a,{fluid:!0},r.a.createElement(x.a,{className:"justify-content-center"},r.a.createElement(w.a,{md:6},r.a.createElement("h1",{style:{color:"#fff"}},"Provas"),this.state.userTests.map(function(t,a){return r.a.createElement(x.a,{style:{background:"#fff",boxShadow:"0 2px 4px 0 rgba(0,0,0,0.16)"},key:a,noGutters:!0,className:"p-2 mb-2 border align-items-center"},r.a.createElement(w.a,{md:"4"},r.a.createElement(U,{src:t.test.img})),r.a.createElement(w.a,{className:"pl-4",md:"6"},r.a.createElement("p",{className:"mb-0"},r.a.createElement("strong",null,"Nome: "),t.test.name),r.a.createElement("p",{className:"mb-0"},r.a.createElement("strong",null,"Data da Prova: "),F()(t.test.due_date).format("DD MMM YYYY")),r.a.createElement("p",{className:"mb-2"},r.a.createElement("strong",null,"Dura\xe7\xe3o: "),t.test.duration," min"),r.a.createElement("p",{className:"mb-0",style:{color:e.getColor(t.status)}},r.a.createElement("strong",null,t.status))),"AGUARDANDO INICIO"===t.status&&r.a.createElement(w.a,{sm:"2"},r.a.createElement(E.a,{to:"/app/test/".concat(t.test.id,"/").concat(t.id)},r.a.createElement(j.a,{color:"primary"},"Iniciar"))))})))))}}]),t}(n.Component),M=a(153);function _(){var e=Object(N.a)(["\n  position: relative;\n  z-index: 5;\n\n  img {\n    height: 25rem;\n    width: 25rem;\n  }\n"]);return _=function(){return e},e}function P(){var e=Object(N.a)(["\n  align-items: center;\n  background-color: rgba(0, 0, 0, 0.5);\n  bottom: 0;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  left: 0;\n  position: fixed;\n  right: 0;\n  top: 0;\n  z-index: 999999;\n"]);return P=function(){return e},e}var L=C.c.div(P()),A=C.c.div(_()),R=function(e){var t=e.visible;return r.a.createElement(r.a.Fragment,null,t&&r.a.createElement(L,null,r.a.createElement(A,null,r.a.createElement(M.a,{size:60,color:"#007bff"}))))},B=a(37),H=(a(51),function(e,t,a){var n=Object(B.a)(e);return-1!==n.map(function(e){return e[t]}).indexOf(a[t])?n.map(function(e){return e[t]===a[t]?a:e}):(n.unshift(a),n)}),q=function(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=(e=e.split(".")).length;return t.sort(function(t,r){for(var s=0;s<n;)-1!==t&&(t=t[e[s]]||""),-1!==r&&(r=r[e[s]]||""),s++;return a&&t<r||!a&&t>r?-1:a&&t>r||!a&&t<r?1:0}),t};function z(){var e=Object(N.a)(["\n  align-items: center;\n  background: ",";\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  justify-content: center;\n  position: relative;\n  width: 100%;\n"]);return z=function(){return e},e}function G(){var e=Object(N.a)(["\n  align-items: center;\n  background-color: #e4e4e4;\n  background-color: rgba(0, 0, 0, 0.03);\n  border-bottom: 1px solid rgba(0, 0, 0, 0.125);\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  padding: 15px;\n  width: 100%;\n\n  > span {\n    font-size: 20px;\n    text-align: center;\n  }\n"]);return G=function(){return e},e}function W(){var e=Object(N.a)(["\n  align-items: center;\n  border: 1px solid rgba(0, 0, 0, 0.125);\n  display: flex;\n  flex-direction: column;\n  height: 250px;\n  justify-content: flex-start;\n  margin-top: 25px;\n  width: 250px;\n"]);return W=function(){return e},e}function J(){var e=Object(N.a)(["\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  justify-content: space-between;\n  width: 70%;\n"]);return J=function(){return e},e}function Q(){var e=Object(N.a)(["\n  border-top: 1px solid #dee2e6;\n  padding: 12px;\n  vertical-align: top;\n"]);return Q=function(){return e},e}function V(){var e=Object(N.a)(["\n  background-color: rgba(0, 0, 0, 0.03);\n"]);return V=function(){return e},e}function Z(){var e=Object(N.a)(["\n  background-color: ",";\n"]);return Z=function(){return e},e}function X(){var e=Object(N.a)(["\n  color: #212529;\n  margin-bottom: 1rem;\n  width: 100%;\n"]);return X=function(){return e},e}function $(){var e=Object(N.a)(["\n  width: 50%;\n"]);return $=function(){return e},e}function K(){var e=Object(N.a)(["\n  margin: 50px;\n"]);return K=function(){return e},e}var ee=C.c.div(K()),te=C.c.div($()),ae=C.c.table(X()),ne=C.c.tr(Z(),function(e){return e.background}),re=C.c.tr(V()),se=C.c.td(Q()),ce=C.c.div(J()),oe=C.c.div(W()),ie=C.c.div(G()),le=C.c.div(z(),function(e){return e.bgColor}),ue=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(m.a)(this,Object(d.a)(t).call(this))).getBackgroundColor=function(e){switch(e){case 1:case 2:return"#afaf00";case 3:return"#c0c000";case 5:return"#e2df22";case 8:return"#e65c00";case 13:return"#f44242";default:return""}},e.getFraudeData=function(e){return e<10?{color:"#0b910d",text:"Baixo risco"}:e<20?{color:"#dde02f",text:"Risco razo\xe1vel"}:e<25?{color:"#d39730",text:"Risco eminente"}:e<35?{color:"#9b2b99",text:"Risco alto"}:{color:"#f00",text:"Fraude"}},e.calculateFraude=function(){for(var t=e.state.events,a=0,n=0;n<t.length;n++)a+=t[n].type.weight;e.setState({fraude:a})},e.renderCard=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#fff";return r.a.createElement(oe,null,r.a.createElement(ie,{tag:"h3"},r.a.createElement("span",null,e)),r.a.createElement(le,{bgColor:a},r.a.createElement("h1",{style:{color:"Rating"===e&&"#fff"}},t)))},e.state={open:!1,focusAfterClose:!0,keywordsAndSaid:JSON.parse(sessionStorage.getItem("keywordsAndSaid"))||{keywords:[],said:[]},fraude:0,events:[],loading:!1},e}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){var e=this;this.setState({loading:!0}),setTimeout(function(){S.get("/user-test-event-get/".concat(e.props.match.params.userTestId)).then(function(t){var a=t.data;a&&a.length?(a=a.map(function(e){return e.started_at=F()(e.started_at).format("DD/MM/YYYY HH:mm:ss"),e.finished_at=F()(e.finished_at).format("DD/MM/YYYY HH:mm:ss"),e.weight=e.type.weight,e}),e.setState({loading:!1,events:q("weight",a,!1)},function(){e.calculateFraude()})):e.setState({loading:!1,events:[]},function(){e.calculateFraude()})})},2e3)}},{key:"render",value:function(){var e=this,t=this.getFraudeData(this.state.fraude),a=t.text,n=t.color;return r.a.createElement(r.a.Fragment,null,r.a.createElement(R,{visible:this.state.loading}),r.a.createElement(ee,null,r.a.createElement(x.a,{className:"justify-content-center"},r.a.createElement(ce,null,this.renderCard("Eventos",this.state.events.length),this.renderCard("Palavras Pronunciadas","".concat(this.state.keywordsAndSaid.said.length,"/").concat(this.state.keywordsAndSaid.keywords.length)),this.renderCard("Rating",a,n)))),r.a.createElement(x.a,{className:"justify-content-center"},r.a.createElement(te,null,r.a.createElement(ae,null,r.a.createElement("thead",null,r.a.createElement(re,null,r.a.createElement(se,{scope:"col"},r.a.createElement("b",null,"Palavras Pronunciadas")))),r.a.createElement("tbody",null,this.state.keywordsAndSaid.said.map(function(e,t){return r.a.createElement(ne,{key:t},r.a.createElement(se,null,e))}))))),r.a.createElement(ee,null,r.a.createElement(x.a,{className:"justify-content-center"},r.a.createElement("h2",null,"Eventos Registrados"))),r.a.createElement(x.a,{className:"justify-content-center"},r.a.createElement(te,null,r.a.createElement(ae,null,r.a.createElement("thead",null,r.a.createElement(re,null,r.a.createElement(se,{scope:"col"},r.a.createElement("b",null,"#")),r.a.createElement(se,{scope:"col"},r.a.createElement("b",null,"Evento")),r.a.createElement(se,{scope:"col"},r.a.createElement("b",null,"Peso")),r.a.createElement(se,{scope:"col"},r.a.createElement("b",null,"In\xedcio")),r.a.createElement(se,{scope:"col"},r.a.createElement("b",null,"Fim")))),r.a.createElement("tbody",null,this.state.events.map(function(t,a){return r.a.createElement(ne,{key:a,background:e.getBackgroundColor(t.type.weight)},r.a.createElement(se,{scope:"row"},a+1),r.a.createElement(se,null,t.type.type),r.a.createElement(se,null,t.type.weight),r.a.createElement(se,null,t.started_at),r.a.createElement(se,null,t.finished_at))}))))))}}]),t}(n.Component),me=a(17),de=a.n(me),fe=a(73),he=a(46),pe=a(36),ve=a(20),ge=a(154),be=a.n(ge),Ee=a(303),ye=a(304),xe=a(305),we=a(306),je=a(307),Oe=.5;function Se(){return ke.apply(this,arguments)}function ke(){return(ke=Object(pe.a)(de.a.mark(function e(){var t;return de.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="/models",e.next=3,ve.j(t);case 3:return e.next=5,ve.h(t);case 5:return e.next=7,ve.i(t);case 7:return e.next=9,ve.l.faceLandmark68Net.loadFromUri(t);case 9:return e.next=11,ve.g(t);case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Fe(e){return Ne.apply(this,arguments)}function Ne(){return(Ne=Object(pe.a)(de.a.mark(function e(t){var a,n,r,s,c,o=arguments;return de.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.length>1&&void 0!==o[1]?o[1]:512,.5,n=new ve.c({inputSize:a,scoreThreshold:.5}),r=!0,e.next=6,ve.f(t);case 6:return s=e.sent,e.next=9,ve.d(s,n).withFaceLandmarks(r).withFaceDescriptors();case 9:return c=e.sent,e.abrupt("return",c);case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Ce(e){return Ie.apply(this,arguments)}function Ie(){return(Ie=Object(pe.a)(de.a.mark(function e(t){var a,n,r;return de.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object.keys(t),n=a.map(function(e){return new ve.b(t[e].name,t[e].descriptors.map(function(e){return new Float32Array(e)}))}),r=new ve.a(n,Oe),e.abrupt("return",r);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function De(){var e=Object(N.a)(["\n  align-items: center;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  justify-content: center;\n  left: 0;\n  position: fixed;\n  top: 0;\n  width: 100%;\n  z-index: 999999;\n  \n  h2 {\n      color: white;\n      text-align: center;\n  }\n"]);return De=function(){return e},e}function Te(){var e=Object(N.a)(["\n  font-size: 0.7rem;\n  margin-bottom: 0;\n"]);return Te=function(){return e},e}function Ue(){var e=Object(N.a)(["\n  align-items: center;\n  background: linear-gradient(to top, #18acc4, #0e5780);\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  min-height: 100vh;\n  width: 100vw;\n"]);return Ue=function(){return e},e}var Ye=C.c.div(Ue()),Me=C.c.p(Te()),_e=C.c.div(De()),Pe=a(44),Le=Object(Pe.a)(),Ae=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).startTracking=Object(pe.a)(de.a.mark(function e(){var t,n,r,s;return de.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.changeTestStatus("EM ANDAMENTO"),e.next=3,Se();case 3:t=document.createElement("canvas"),n=a.webcam.current.video,t.width="100%",t.height="100%",t.style.position="absolute",t.style.left=0,t.style.top=0,a.canvasWrapper.current.appendChild(t),r={width:n.offsetWidth,height:n.offsetHeight},ve.k(t,r),s=setInterval(Object(pe.a)(de.a.mark(function e(){var c,o,i;return de.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve.d(n,new ve.c).withFaceLandmarks().withFaceExpressions();case 2:c=e.sent,o=ve.m(c,r),t.getContext("2d").clearRect(0,0,t.width,t.height),ve.e.drawDetections(t,o),ve.e.drawFaceLandmarks(t,o),ve.e.drawFaceExpressions(t,o),a.state.loading&&!a.state.firstStepDone&&a.setState({loading:!1}),c&&1===c.length&&(i=c[0].expressions,Object.keys(i).forEach(function(e){if(i[e]>.9&&("fearful"===e&&(e="angry"),!a.state.imagesBlob[e]&&a.state.acceptedExpressions.indexOf(e)>-1)){a.setState(Object(he.a)({},a.state,{imagesBlob:Object(he.a)({},a.state.imagesBlob,Object(fe.a)({},e,a.webcam.current.getScreenshot()))}));var n=!0;Object.keys(a.state.imagesBlob).forEach(function(e){a.state.imagesBlob[e]||(n=!1)}),n&&(clearTimeout(s),a.setState({firstStepDone:!0},function(){a.startTest()}),t.remove())}}));case 10:case"end":return e.stop()}},e)})),100);case 14:case"end":return e.stop()}},e)})),a.handleImage=function(){var e=Object(pe.a)(de.a.mark(function e(t){return de.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fe(t).then(function(e){if(!e[0])return!1;a.setState({userDescriptors:[].concat(Object(B.a)(a.state.userDescriptors),[e[0].descriptor])})});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.startTest=Object(pe.a)(de.a.mark(function e(){var t;return de.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new window.webkitSpeechRecognition).continuous=!0,t.interimResults=!0,t.lang="pt-BR",t.onresult=function(e){for(var t="",n=e.resultIndex;n<e.results.length;++n)e.results[n].isFinal&&(t+=e.results[n][0].transcript);a.setState({transcript:a.state.transcript+t})},t.start(),a.setState({loading:!0}),e.next=9,Promise.all(Object.keys(a.state.imagesBlob).map(function(){var e=Object(pe.a)(de.a.mark(function e(t){return de.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.handleImage(a.state.imagesBlob[t]);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 9:return e.t0=a,e.next=12,Ce({USUARIO:{name:a.state.user.name,descriptors:a.state.userDescriptors}});case 12:e.t1=e.sent,e.t2={faceMatcher:e.t1},e.t0.setState.call(e.t0,e.t2),a.startInterval();case 16:case"end":return e.stop()}},e)})),a.renderPredictions=function(e){if(a.canvasRef.current){var t=a.canvasRef.current.getContext("2d");t.clearRect(0,0,t.canvas.width,t.canvas.height);var n="16px sans-serif";t.font=n,t.textBaseline="top",e.forEach(function(e){var a=e.bbox[0],r=e.bbox[1],s=e.bbox[2],c=e.bbox[3];t.strokeStyle="#00FFFF",t.lineWidth=4,t.strokeRect(a,r,s,c),t.fillStyle="#00FFFF";var o=t.measureText(e.class).width,i=parseInt(n,10);t.fillRect(a,r,o+4,i+4)}),e.forEach(function(e){var a=e.bbox[0],n=e.bbox[1];t.fillStyle="#000000",t.fillText(e.class,a,n)})}},a.concludeTest=function(){for(var e=a.state.test.keywords,t=[],n=0;n<e.length;n++)a.state.transcript.toLowerCase().indexOf(e[n].toLowerCase())>0&&t.push(e[n].toLowerCase());var r={keywords:e,said:t};sessionStorage.setItem("keywordsAndSaid",JSON.stringify(r));for(var s=a.state.answers,c=function(e){for(var t=a.state.test.questions.filter(function(t){return t.id===s[e].fk_question})[0].keywords,n=[],r=0;r<t.length;r++)s[e].value.indexOf(t[r].keyword)>0&&n.push(t[r].keyword);var c=H(a.state.answers,"fk_question",Object(he.a)({},s[e],{keysInAnswer:n}));a.setState({answers:c})},o=0;o<s.length;o++)c(o);var i=Object.keys(a.state.anomalyFaceEvents).map(function(e){return a.state.anomalyFaceEvents[e]}),l=Object.keys(a.state.anomalyObjectEvents).map(function(e){return a.state.anomalyObjectEvents[e]});clearInterval(a.state.intervalFaceTest),clearInterval(a.state.intervalObjectTest),clearInterval(a.state.focusInterval),a.canvasRef.current.remove(),S.post("/user-test-event-add",[].concat(Object(B.a)(i),Object(B.a)(l),Object(B.a)(a.state.hasFocusEvents))).then(function(e){e.data;a.changeTestStatus("CONCLUIDO"),setTimeout(function(){Le.push("/app/dashboard/".concat(a.state.userTestId))},1e3)})},a.renderQuestion=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(x.a,{noGutters:!0},r.a.createElement(w.a,null,r.a.createElement(Ee.a,null,r.a.createElement(ye.a,{for:"exampleEmail"},e.question),"TEXTO"===e.type&&r.a.createElement(xe.a,{type:"email",name:"email",id:"exampleEmail",placeholder:"Preencha o campo"}),"MULTIPLA ESCOLHA"===e.type&&r.a.createElement(xe.a,{type:"select",name:"select",id:"exampleSelect"},r.a.createElement("option",null,"Resposta 1"),r.a.createElement("option",null,"Resposta 2"),r.a.createElement("option",null,"Resposta 3"),r.a.createElement("option",null,"Resposta 4"),r.a.createElement("option",null,"Resposta 5"))))))},a.canvasWrapper=r.a.createRef(),a.canvasRef=r.a.createRef(),a.webcam=r.a.createRef(),a.state={test:null,answers:[],imagesBlob:{happy:null,angry:null,sad:null,neutral:null},getExpression:{angry:"Bravo",sad:"Triste",neutral:"Normal",happy:"Feliz"},detections:[],intruserStarted:null,cellPhoneStarted:null,noBodyStarted:null,descriptors:[],userDescriptors:[],anomalyObjectEvents:{},anomalyFaceEvents:{},match:null,faceMatcher:null,acceptedExpressions:["angry","sad","neutral","happy"],firstStepDone:!1,anomalyFace:"",anomalyObject:"",user:{},events:{},intervalTest:null,focusInterval:0,hasFocus:!1,hasFocusEvents:[],intervalFaceTest:null,intervalObjectTest:null,voiceRecognition:null,transcript:""},a}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){var e=this;S.get("/get-event-type").then(function(t){var a=t.data,n={};a.map(function(e){n[e.key]=e.id}),e.setState({events:n})});var t=this.props.match.params,a=t.testId,n=t.userTestId;this.setState({testId:a}),S.get("get-test/".concat(a)).then(function(t){var a=t.data;e.setState({test:a})});var r=sessionStorage.getItem("userLogged");this.setState({user:JSON.parse(r),userTestId:n}),this.setState({loading:!0})}},{key:"componentDidMount",value:function(){var e=this;this.webcam.current.video.addEventListener("play",function(){e.startTracking()}),this.setState({hasFocus:document.hasFocus()});var t=setInterval(function(){var t=e.state.events.LEFTTEST,a=e.state.hasFocusEvents.filter(function(e){return e.fk_type===t&&!e.finished_at});if(document.hasFocus()){if(0===a.length)return;var n=e.state.hasFocusEvents.map(function(e){return e.fk_type!==t||e.finished_at?e:Object(he.a)({},e,{finished_at:F()().format("YYYY-MM-DD HH:mm:ss")})});e.setState({hasFocusEvents:n})}else{if(a.length>0)return;e.setState({hasFocusEvents:[].concat(Object(B.a)(e.state.hasFocusEvents),[{fk_user_test:e.state.userTestId,fk_type:t,started_at:F()().format("YYYY-MM-DD HH:mm:ss"),finished_at:""}])})}},1e3);this.setState({focusInterval:t})}},{key:"changeTestStatus",value:function(e){S.put("/user-test/set-status",{id:this.state.userTestId,status:e}).then(function(e){e.data})}},{key:"startInterval",value:function(){var e=this,t=setInterval(Object(pe.a)(de.a.mark(function t(){return de.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:window.cocossdLoaded&&window.cocossdLoaded.detect(e.webcam.current.video).then(function(t){t=t.filter(function(e){return"cell phone"===e.class}),e.checkObjectAnomaly(t),e.renderPredictions(t)});case 1:case"end":return t.stop()}},t)})),500),a=setInterval(Object(pe.a)(de.a.mark(function t(){var a,n;return de.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=null,t.next=3,Fe(e.webcam.current.getScreenshot(),160).then(function(t){t&&e.setState({detections:t.map(function(e){return e.detection}),descriptors:t.map(function(e){return e.descriptor})})});case 3:if(!e.state.descriptors||!e.state.faceMatcher){t.next=9;break}return t.next=6,e.state.descriptors.map(function(t){return e.state.faceMatcher.findBestMatch(t)});case 6:n=t.sent,a=n,e.setState({match:n});case 9:e.checkFaceAnomaly(a),e.state.loading&&e.setState({loading:!1});case 11:case"end":return t.stop()}},t)})),500);this.setState({intervalFaceTest:a,intervalObjectTest:t})}},{key:"checkObjectAnomaly",value:function(e){if(e&&e.length)this.state.cellPhoneStarted||this.setState({cellPhoneStarted:F()().format("YYYY-MM-DD HH:mm:ss.SSS")}),this.setState({anomalyObject:"N\xe3o \xe9 permitido a utiliza\xe7\xe3o de celulares durante a prova, por favor, guarde-o."});else{var t=Object(he.a)({},this.state.anomalyObjectEvents);if(this.state.cellPhoneStarted){var a=this.state.cellPhoneStarted;t[a]={fk_user_test:this.state.userTestId,fk_type:this.state.events.CELLPHONE,started_at:a,finished_at:F()().format("YYYY-MM-DD HH:mm:ss.SSS")}}this.setState({anomalyObjectEvents:t,anomalyObject:"",cellPhoneStarted:null})}}},{key:"checkFaceAnomaly",value:function(e){if(!e||!e.length||1===e.length&&"unknown"===e[0]._label)this.state.noBodyStarted||this.setState({noBodyStarted:F()().format("YYYY-MM-DD HH:mm:ss.SSS")}),this.setState({anomalyFace:"Nenhum usu\xe1rio encontrado"});else if(e.length>1)this.state.intruserStarted||this.setState({intruserStarted:F()().format("YYYY-MM-DD HH:mm:ss.SSS")}),this.setState({anomalyFace:"Mais de um usu\xe1rio na c\xe2mera, por favor, fique sozinho no ambiente."});else{var t=Object(he.a)({},this.state.anomalyFaceEvents);if(this.state.intruserStarted){var a=this.state.intruserStarted;t[a]={fk_user_test:this.state.userTestId,fk_type:this.state.events.SOMEBODY,started_at:a,finished_at:F()().format("YYYY-MM-DD HH:mm:ss.SSS")}}if(this.state.noBodyStarted){var n=this.state.noBodyStarted;t[n]={fk_user_test:this.state.userTestId,fk_type:this.state.events.NOBODY,started_at:n,finished_at:F()().format("YYYY-MM-DD HH:mm:ss.SSS")}}this.setState({anomalyFaceEvents:t,anomalyFace:"",noBodyStarted:null,intruserStarted:null})}}},{key:"getDetections",value:function(){var e=this.state,t=e.match;return e.detections.map(function(e,a){var n=e.box.height,s=e.box.width,c=e.box._x,o=e.box._y;return r.a.createElement("div",{key:a},r.a.createElement("div",{style:{position:"absolute",border:"solid",borderColor:"blue",left:0,top:0,height:n,width:s,transform:"translate(".concat(c,"px,").concat(o,"px)")}},t&&t[a]?r.a.createElement("p",{style:{backgroundColor:"blue",border:"solid",borderColor:"blue",width:s,marginTop:0,top:0,left:0,color:"#fff",transform:"translate(-3px,".concat(n,"px)")}},t[a]._label):null))})}},{key:"getTextAnswer",value:function(e){var t=this.state.answers.filter(function(t){return t.fk_question===e.id});return t.length>0?t[0].value:""}},{key:"render",value:function(){var e,t=this;return e=this.getDetections(),r.a.createElement(Ye,null,r.a.createElement(R,{visible:this.state.loading}),r.a.createElement(y.a,{fluid:!0},!this.state.firstStepDone&&r.a.createElement(x.a,{className:"justify-content-center mb-2"},r.a.createElement(w.a,{style:{background:"#fff",boxShadow:"0 0 5px #fff",borderRadius:"4px"},sm:6,className:"border p-2"},r.a.createElement("p",{className:"mb-1 text-muted"},"Primeiro precisamos identificar que voc\xea existe, fa\xe7a as seguintes express\xf5es faciais para continuar: "),r.a.createElement(x.a,null,r.a.createElement(w.a,null,r.a.createElement(Me,{className:"text-muted mb-0"},"Sorria -",r.a.createElement(we.a,{className:"ml-1",href:"#",color:this.state.imagesBlob.happy?"success":"danger"},this.state.imagesBlob.happy?"Concluido":"Pendente"))),r.a.createElement(w.a,null,r.a.createElement(Me,{className:"text-muted mb-0"},"Triste -",r.a.createElement(we.a,{className:"ml-1",href:"#",color:this.state.imagesBlob.sad?"success":"danger"},this.state.imagesBlob.sad?"Concluido":"Pendente"))),r.a.createElement(w.a,null,r.a.createElement(Me,{className:"text-muted mb-0"},"Bravo -",r.a.createElement(we.a,{className:"ml-1",href:"#",color:this.state.imagesBlob.angry?"success":"danger"},this.state.imagesBlob.angry?"Concluido":"Pendente"))),r.a.createElement(w.a,null,r.a.createElement(Me,{className:"text-muted mb-0"},"Neutro -",r.a.createElement(we.a,{className:"ml-1",href:"#",color:this.state.imagesBlob.neutral?"success":"danger"},this.state.imagesBlob.neutral?"Concluido":"Pendente")))))),this.state.firstStepDone&&r.a.createElement(x.a,{className:"justify-content-center mb-2"},r.a.createElement(w.a,{style:{background:"#fff",boxShadow:"0 0 5px #fff",borderRadius:"4px"},sm:6,className:"border p-2"},r.a.createElement("p",{className:"mb-1 text-muted"},"Parab\xe9ns, agora podemos iniciar a prova, voc\xea pode avaliar suas imagens abaixo:"),r.a.createElement(x.a,{noGutters:!0},Object.keys(this.state.imagesBlob).map(function(e,a){return r.a.createElement(w.a,{sm:3,className:"text-center"},r.a.createElement(Me,null,t.state.getExpression[e]),r.a.createElement("img",{key:a,alt:e,src:t.state.imagesBlob[e],width:"100",height:"100"}))})))),r.a.createElement(x.a,{className:"justify-content-center"},r.a.createElement(w.a,{className:"col-auto"},r.a.createElement("div",{style:{position:"relative"},ref:this.canvasWrapper},r.a.createElement(be.a,{audio:!1,height:240,width:320,ref:this.webcam,style:{boxShadow:"0 0 5px #fff",borderRadius:"3px"},videoConstraints:{width:320,height:240,facingMode:"user"},screenshotFormat:"image/jpeg"}),e||null),this.state.firstStepDone&&r.a.createElement("canvas",{style:{position:"absolute",left:0,top:0},className:"size",ref:this.canvasRef,width:320,height:240})),this.state.test&&this.state.firstStepDone&&r.a.createElement(w.a,{style:{background:"#fff",boxShadow:"0 0 5px #fff",borderRadius:"4px",maxHeight:"500px",overflowY:"auto"},className:"border p-2 mr-2"},r.a.createElement(je.a,null,this.state.test.questions.map(function(e){return t.renderQuestion(e)})),r.a.createElement(x.a,{noGutters:!0},r.a.createElement(w.a,null,r.a.createElement(j.a,{color:"primary",onClick:this.concludeTest},"Concluir Prova"))))),(this.state.anomalyFace.length>0||this.state.anomalyObject.length>0)&&r.a.createElement(_e,null,this.state.anomalyFace.length>0&&r.a.createElement("h2",null,this.state.anomalyFace),this.state.anomalyObject.length>0&&r.a.createElement("h2",null,this.state.anomalyObject))))}}]),t}(n.Component),Re=function(e){function t(){return Object(l.a)(this,t),Object(m.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement(p.a,{history:Le},r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,null,r.a.createElement(g.a,{path:"/app/main",component:Y}),r.a.createElement(g.a,{path:"/app/test/:testId/:userTestId",component:Ae}),r.a.createElement(g.a,{path:"/app/dashboard/:userTestId",component:ue}),r.a.createElement(g.a,{exact:!0,path:"/app/*",render:function(){return r.a.createElement(b.a,{to:"/app/main"})}}))))}}]),t}(n.Component),Be=function(e){return e.valid=!0,e.submited=!0,e.invalidFields=[],Object.keys(e.controls).map(function(t){var a=e.controls[t];return a.valid=!0,a.invalid=!1,a.required&&!a.value&&(e.valid=a.valid=!1,a.invalid=!0),!a.isSelect||a.value&&-1!==a.value?a.minLength&&(!a.value||a.value.length<a.minLength)?(e.valid=a.valid=!1,a.invalid=!0):a.maxLength&&(!a.value||a.value.length>a.maxLength)?(e.valid=a.valid=!1,a.invalid=!0):a.minSlices&&a.value.split(" ").length<a.minSlices?(e.valid=a.valid=!1,a.invalid=!0):a.isCPF&&!He(a.value)?(e.valid=a.valid=!1,a.invalid=!0):a.isEmail&&!/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(a.value)?(e.valid=a.valid=!1,a.invalid=!0):a.minNumber&&a.minNumber>a.value?(e.valid=a.valid=!1,a.invalid=!0):a.validDate&&a.required&&!F()(a.value).isValid()&&(e.valid=a.valid=!1,a.invalid=!0):(e.valid=a.valid=!1,a.invalid=!0),a.valid||e.invalidFields.push(a.alias||t),!0}),e},He=function(e){if(""===(e=e.replace(/[^\d]+/g,"")))return!1;if(11!==e.length||"00000000000"===e||"11111111111"===e||"22222222222"===e||"33333333333"===e||"44444444444"===e||"55555555555"===e||"66666666666"===e||"77777777777"===e||"88888888888"===e||"99999999999"===e)return!1;for(var t=0,a=0,n=0;n<10;n++)a+=parseInt(e.charAt(n))*(11-n),n<9&&(t+=parseInt(e.charAt(n))*(10-n));var r=11-t%11,s=11-a%11;return 10!==r&&11!==r||(r=0),10!==s&&11!==s||(s=0),r===parseInt(e.charAt(9))&&s===parseInt(e.charAt(10))},qe=function(e){var t={};return Object.keys(e.controls).map(function(a){return t[a]=e.controls[a].value}),t},ze=a(77),Ge=a.n(ze),We=a(309),Je=a(310);function Qe(){var e=Object(N.a)(["\n  height: auto;\n  width: 100px;\n"]);return Qe=function(){return e},e}function Ve(){var e=Object(N.a)(["\n  align-items: center;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  min-height: 100vh;\n  width: 100vw;\n"]);return Ve=function(){return e},e}var Ze=C.c.div(Ve()),Xe=C.c.img(Qe()),$e=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={errors:null,loading:!1,formUser:{controls:{email:{value:"mateus.pereira@quero.com.br",required:!0,isEmail:!0,maxLength:100,alias:"Email"},password:{value:"123123",required:!0,minLength:1,maxLength:100,alias:"Senha"}}}},a.handleFormChange=function(e,t){var n=Object.assign({},a.state.formUser);n.controls[e].value=t,a.setState({formUser:n})},a.doLogin=function(e){a.setState({loading:!0}),e.preventDefault(),a.setState({formUser:Be(a.state.formUser)},function(){if(a.state.formUser.valid){var e=qe(a.state.formUser);S.post("/auth",e).then(function(e){var t=e.data;if(!t)return alert("iasd"),void a.setState({loading:!1});sessionStorage.setItem("userLogged",JSON.stringify(t)),a.setState({loading:!1}),Le.push("/app/")})}})},a}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(Ze,null,r.a.createElement(y.a,{fluid:!0},r.a.createElement(x.a,{className:"justify-content-center"},r.a.createElement(w.a,{className:"text-center",sm:4},r.a.createElement(Xe,{src:Ge.a,alt:"logo-truetest",style:{width:"500px"}}))),r.a.createElement(x.a,{className:"mb-2 justify-content-center"},r.a.createElement(w.a,{sm:3},r.a.createElement(je.a,{onSubmit:function(t){return e.doLogin(t)},style:{background:"#fff",boxShadow:"0 2px 4px 0 rgba(0,0,0,0.16)",padding:"1.5rem"}},r.a.createElement(Ee.a,null,r.a.createElement(ye.a,{for:"email"},"Email"),r.a.createElement(xe.a,{invalid:this.state.formUser.controls.email.invalid,valid:this.state.formUser.controls.email.valid,type:"email",name:"email",id:"email",placeholder:"Insira o email",value:this.state.formUser.controls.email.value,onChange:function(t){return e.handleFormChange("email",t.target.value)}}),this.state.formUser.controls.email.invalid&&r.a.createElement(We.a,{invalid:!0},"Preencha corretamente o Email")),r.a.createElement(Ee.a,null,r.a.createElement(ye.a,{for:"password"},"Senha"),r.a.createElement(xe.a,{invalid:this.state.formUser.controls.password.invalid,valid:this.state.formUser.controls.password.valid,type:"password",name:"password",id:"password",placeholder:"Insira a senha",value:this.state.formUser.controls.password.value,onChange:function(t){return e.handleFormChange("password",t.target.value)}}),this.state.formUser.controls.password.invalid&&r.a.createElement(We.a,{invalid:!0},"Preencha corretamente a Senha")),r.a.createElement(x.a,{className:"justify-content-center mb-3"},r.a.createElement(w.a,{sm:12},r.a.createElement(j.a,{type:"submit",color:"primary",className:"col-sm-12"},this.state.loading?r.a.createElement(Je.a,{animation:"border",size:"sm"}):r.a.createElement("span",null,"Entrar")))),r.a.createElement(x.a,{noGutters:!0,className:"justify-content-center"},r.a.createElement(w.a,{className:"col-auto"},"Ainda n\xe3o tem cadastro?\xa0",r.a.createElement(E.a,{to:"/login/sign-up"},"Cadastre-se"))))))))}}]),t}(n.Component);function Ke(){var e=Object(N.a)(["\n  height: auto;\n  width: 100px;\n"]);return Ke=function(){return e},e}function et(){var e=Object(N.a)(["\n  align-items: center;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  min-height: 100vh;\n  width: 100vw;\n"]);return et=function(){return e},e}var tt=C.c.div(et()),at=C.c.img(Ke()),nt=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={errors:null,loading:!1,formUser:{controls:{name:{value:"",required:!0,minLength:6,maxLength:100,alias:"Nome",minSlices:2},email:{value:"",required:!0,isEmail:!0,maxLength:100,alias:"Email"},document:{value:"",required:!0,isCPF:!0,alias:"CPF"},password:{value:"",required:!0,minLength:8,maxLength:100,alias:"Senha"}}}},a.handleFormChange=function(e,t){var n=Object.assign({},a.state.formUser);n.controls[e].value=t,a.setState({formUser:n})},a.doRegister=function(e){e.preventDefault(),a.setState({formUser:Be(a.state.formUser)},function(){a.state.formUser.valid})},a}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(tt,null,r.a.createElement(y.a,{fluid:!0},r.a.createElement(x.a,{className:"justify-content-center"},r.a.createElement(w.a,{className:"text-center",sm:4},r.a.createElement(at,{src:Ge.a,alt:"logo-truetest",style:{width:"500px"}}))),r.a.createElement(x.a,{className:"mb-2 justify-content-center"},r.a.createElement(w.a,{sm:3},r.a.createElement(je.a,{onSubmit:function(t){return e.doRegister(t)},style:{background:"#fff",boxShadow:"0 2px 4px 0 rgba(0,0,0,0.16)",padding:"1.5rem"}},r.a.createElement(Ee.a,null,r.a.createElement(ye.a,{for:"name"},"Nome"),r.a.createElement(xe.a,{invalid:this.state.formUser.controls.name.invalid,valid:this.state.formUser.controls.name.valid,type:"text",name:"name",id:"name",placeholder:"Insira o nome",value:this.state.formUser.controls.name.value,onChange:function(t){return e.handleFormChange("name",t.target.value)}}),this.state.formUser.controls.name.invalid&&r.a.createElement(We.a,{invalid:!0},"Preencha corretamente o Nome")),r.a.createElement(Ee.a,null,r.a.createElement(ye.a,{for:"email"},"Email"),r.a.createElement(xe.a,{invalid:this.state.formUser.controls.email.invalid,valid:this.state.formUser.controls.email.valid,type:"email",name:"email",id:"email",placeholder:"Insira o email",value:this.state.formUser.controls.email.value,onChange:function(t){return e.handleFormChange("email",t.target.value)}}),this.state.formUser.controls.email.invalid&&r.a.createElement(We.a,{invalid:!0},"Preencha corretamente o Email")),r.a.createElement(Ee.a,null,r.a.createElement(ye.a,{for:"cpf"},"CPF"),r.a.createElement(xe.a,{invalid:this.state.formUser.controls.document.invalid,valid:this.state.formUser.controls.document.valid,type:"text",name:"email",id:"cpf",placeholder:"Insira o CPF",value:this.state.formUser.controls.document.value,onChange:function(t){return e.handleFormChange("document",t.target.value)}}),this.state.formUser.controls.document.invalid&&r.a.createElement(We.a,{invalid:!0},"Preencha corretamente o CPF")),r.a.createElement(Ee.a,null,r.a.createElement(ye.a,{for:"password"},"Senha"),r.a.createElement(xe.a,{invalid:this.state.formUser.controls.password.invalid,valid:this.state.formUser.controls.password.valid,type:"password",name:"password",id:"password",placeholder:"Insira a senha",value:this.state.formUser.controls.password.value,onChange:function(t){return e.handleFormChange("password",t.target.value)}}),this.state.formUser.controls.password.invalid&&r.a.createElement(We.a,{invalid:!0},"Preencha corretamente a Senha")),r.a.createElement(x.a,{noGutters:!0,className:"justify-content-center mb-3"},r.a.createElement(w.a,{sm:12},r.a.createElement(j.a,{type:"submit",className:"ml-1 col-sm-12",color:"primary"},"Cadastrar"))),r.a.createElement(x.a,{noGutters:!0,className:"justify-content-center"},r.a.createElement(w.a,{className:"col-auto"},"J\xe1 tem conta?\xa0",r.a.createElement(E.a,{to:"/login/sign-in"},"Fa\xe7a login"))))))))}}]),t}(n.Component),rt=function(e){function t(){return Object(l.a)(this,t),Object(m.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement(p.a,{history:Le},r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,null,r.a.createElement(g.a,{path:"/login/sign-in",component:$e}),r.a.createElement(g.a,{path:"/login/sign-up",component:nt}),r.a.createElement(g.a,{exact:!0,path:"/login/",render:function(){return r.a.createElement(b.a,{to:"/login/sign-in"})}}))))}}]),t}(n.Component),st=a(156),ct=(a(31),function(e){function t(){return Object(l.a)(this,t),Object(m.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){console.log("starting loading cocossd"),st.a("lite_mobilenet_v2").then(function(e){console.log("loaded cocossd..."),window.cocossdLoaded=e})}},{key:"render",value:function(){return r.a.createElement(h.a,{history:Le},r.a.createElement(v.a,null,r.a.createElement(g.a,{exact:!0,path:"/",render:function(){return r.a.createElement(b.a,{to:"/login"})}}),r.a.createElement(g.a,{path:"/app",component:Re}),r.a.createElement(g.a,{path:"/login",component:rt}),r.a.createElement(g.a,{path:"*",component:rt})))}}]),t}(n.Component)),ot=a(42),it=a(146),lt=a(157),ut=Object(ot.c)({router:Object(h.b)(Le)}),mt=a(159),dt=de.a.mark(ft);function ft(){return de.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(mt.a)([]);case 2:case"end":return e.stop()}},dt)}var ht=Object(lt.a)(),pt=[ht,Object(it.a)(Le)],vt=Object(ot.e)(Object(h.b)(Le)(ut),ot.a.apply(void 0,pt));function gt(){var e=Object(N.a)(["\n  *{\n    box-sizing: border-box;\n    margin: 0;\n    outline: 0;\n    padding: 0;\n    font-family: 'Montserrat', sans-serif;\n  }\n\n  html, body, #root {\n    height: 100%;\n    overflow-x: hidden;\n  }\n"]);return gt=function(){return e},e}ht.run(ft);var bt=Object(C.a)(gt());a(295);c.a.render(r.a.createElement(o.a,{store:vt},r.a.createElement(r.a.Fragment,null,r.a.createElement(ct,null),r.a.createElement(bt,null),r.a.createElement(i.ToastContainer,{autoClose:4e3}))),document.getElementById("root"))},77:function(e,t,a){e.exports=a.p+"static/media/cover.9c6c582a.png"}},[[161,1,2]]]);
//# sourceMappingURL=main.f4c999ea.chunk.js.map